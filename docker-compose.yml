services:
  central:
    image: distribuidos/central
    build:
      context: .
      dockerfile: dockerfile-central
    networks:
      - mynetwork
    ports:
      - "1090:1090"
    command: ["20", "10", "backup"]

  Backup:
    image: distribuidos/replica
    build:
      context: .
      dockerfile: dockerfile-replica
    networks:
      - mynetwork
    ports:
      - "1092:1092"
    command: ["central", "10000"]

  facultad:
    image: distribuidos/facultad
    build:
      context: .
      dockerfile: dockerfile-facultad
    networks:
      - mynetwork
    ports:
      - "1081:1081"
    command: ["Ingeniería", "2025-1", "central", "1081", "backup"]

  programas:
    image: distribuidos/programas
    build:
      context: .
      dockerfile: dockerfile-programa
    networks:
      - mynetwork
    command: ["Ingeniería de Sistemas", "2025-1", "Ingeniería", "3", "2", "facultad:1081"]
    
  mongo:
    image: mongo
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: user
      MONGO_INITDB_ROOT_PASSWORD: pass
    ports:
      - "27017:27017"
    networks:
      - mynetwork

networks:
  mynetwork:
    driver: bridge
